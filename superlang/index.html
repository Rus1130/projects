<style>
    :root {
        --output-string-color: #000000;
        --output-number-color: #5151fd;
        --output-boolean-color: #5151fd;
    }
    body {
        font-family: monospace;
        padding: 20px;
        background: #f6f8fa;
    }

    div#editor {
        width: 100%;
        min-height: 150px;
        font-family: monospace;
        font-size: 14px;
        overflow: hidden;
        background-color: #fff;
        border: 1px solid #ccc;
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
        padding: 10px;
    }

    #lineNumbers {
        user-select: none;
        text-align: right;
        padding: 10px 5px 10px 10px;
        color: #888;
        background-color: #f0f0f0;
    }

    div#editor:focus {
        outline: none;
        background-color: #fff;
        border: 1px solid #ccc;
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
    }

    #output {
        background: #fff;
        color: #000000;
        border: 1px solid #ccc;
        padding: 10px;
        border-radius: 4px;
        min-height: 40px;
    }

    #editorWrapper {
        display: flex;
        width: 100%;
        min-height: 150px;
        font-family: monospace;
        font-size: 14px;
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 4px;
        overflow: hidden;
    }

    .output-line {
        white-space: pre;
    }
</style>
<head>
    <script src="index.js"></script>
</head>
<body>
    <h1>SuperLang Interpreter</h1>

    <!--
            "var a = 0",
            "var b = 1",
            "var temp = 0",
            "var times = ''",
            "",
            "ask $times 'How many Fibonacci numbers would you like to generate?'",
            "",
            "loop times>toNumber {",
            "   out a",
            "   set $b = a>add(b)",
            "   set $a = temp",
            "   set $temp = b",
            "}"
    -->
    <div id="editorWrapper">
        <div id="lineNumbers"></div>
        <div id="editor" contenteditable="plaintext-only">

func fibonacci(n) {
    a = 0
    b = 1
    temp = 0

    loop n {
        b = a + b
        a = temp
        temp = b
        print($"|__iter__|: |a|")
    }
}

@fibonacci(10)


        </div>
    </div>
    <br>
    <button id="runBtn">Run</button>

    <h2>Output:</h2>
    <div id="output"></div>
</body>
<script>
    const editor = document.getElementById("editor");
    const output = document.getElementById("output");
    const lineNumbers = document.getElementById("lineNumbers");

    function outputToTerminal(value) {
        const line = document.createElement("div");
        const type = getType(value);
        
        let text;

        if (type === "string") {
            line.style.color = "var(--output-string-color)";
        } else if (type === "number") {
            line.style.color = "var(--output-number-color)";
        } else if (type === "boolean") {
            line.style.color = "var(--output-boolean-color)";
        } else if (type === "error") {
            line.style.color = "red";
            text = value.value;
        }

        if(text === undefined) text = value;

        line.innerHTML = text;
        line.className = "output-line";
        output.appendChild(line);
    }

    function updateLineNumbers() {
        const lines = editor.innerText.split("\n").length;
        lineNumbers.innerHTML = Array.from({length: lines}, (_, i) => i+1).join("<br>");
    }

    // Initial update
    updateLineNumbers();

    // Update on input
    editor.addEventListener("input", updateLineNumbers);

    // Keep line numbers scroll in sync
    editor.addEventListener("scroll", () => {
        lineNumbers.scrollTop = editor.scrollTop;
    });

    function runButton(){
        const code = editor.innerText;
        try {
            output.innerHTML = "";
            evaluateProgram(code);
        } catch (err) {
            output.textContent = "Error: " + err.message;
        }
    }

    document.getElementById("runBtn").addEventListener("click", runButton);

    runButton();
</script>