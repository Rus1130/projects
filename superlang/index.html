<style>
    :root {
        --output-string-color: #000000;
        --output-number-color: #5151fd;
        --output-boolean-color: #5151fd;
        --output-array-color: #ff569a;
    }
    body {
        font-family: monospace;
        padding: 20px;
        background: #f6f8fa;
    }

    div#editor {
        width: 100%;
        min-height: 150px;
        font-family: monospace;
        font-size: 14px;
        overflow: hidden;
        background-color: #fff;
        border: 1px solid #ccc;
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
        padding: 10px;
    }

    #lineNumbers {
        user-select: none;
        text-align: right;
        padding: 10px 5px 10px 10px;
        color: #888;
        background-color: #f0f0f0;
    }

    div#editor:focus {
        outline: none;
        background-color: #fff;
        border: 1px solid #ccc;
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
    }

    #output {
        background: #fff;
        color: #000000;
        border: 1px solid #ccc;
        padding: 10px;
        border-radius: 4px;
        min-height: 40px;
        white-space: pre-wrap !important;
    }

    #editorWrapper {
        display: flex;
        width: 100%;
        min-height: 150px;
        font-family: monospace;
        font-size: 14px;
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 4px;
        overflow: hidden;
    }

    .output-line {
        white-space: pre;
    }
</style>
<head>
    <script src="old.js"></script>
</head>
<body>
    <h1>SuperLang Interpreter</h1>

    <div id="editorWrapper">
        <div id="lineNumbers"></div>
        <div id="editor" contenteditable="plaintext-only">

<!-- array = [1, 2, 3, 4, 5]

array = array>map(@(x){
    return x * 3
})

x = @(out){
    return out
}

print(@x('meow')) -->

<!-- func wrapper(func){
    print("Starting wrapper")
    @func
    print("Ending wrapper")
}

x = 21

@wrapper(@(){
    if(x > 20){
        print("big")
    } else {
        print("small")
    }
}) -->

!x = 'hello!'
func x (hi){
    print(hi + ' world!')
}

print(x)

<!-- pee = #{
    'name' = 'Whiskers'
    'age' = 3
    'colors' = ['black', 'white']
}

func meow(hi){
    print(hi + " meow")
}

@meow("hello")

debug>env -->

<!-- func fibonacci(n) {
    a = 0
    b = 1
    temp = 0

    loop n {
        b = a + b
        a = temp
        temp = b
        print(a)
    }
}

@fibonacci(10) -->
<!-- num = 20
print(@(){
    if(num > 20){
        return "big"
    } else {
        return "small"
    }
}>call) -->
            <!-- print(match 0 {
                0 -> "zero"
                1 -> "one"
                _ -> "many"
            }) -->
<!-- x = #{
    'name' = 'Alice'
    'age' = 30
    'nested' = #{
        'key' = 'value'
    }
}
// print(x) -->
        </div>
    </div>
    <br>
    <button id="runBtn">Run</button>

    <h2>Output:</h2>
    <div id="output"></div>
</body>
<script>
    const editor = document.getElementById("editor");
    const output = document.getElementById("output");
    const lineNumbers = document.getElementById("lineNumbers");

    function outputToTerminal(value) {
        const line = document.createElement("div");

        if(value?.type === "error"){
            line.style.color = "red";
            line.innerHTML = value.value;
            output.appendChild(line);
            return;
        }

        function color(val) {
            const span = document.createElement("span");
            const type = getType(val); // calculate type per item

            if (type === "string") {
                span.style.color = "var(--output-string-color)";
                span.innerHTML = val;
            } else if (type === "number") {
                span.style.color = "var(--output-number-color)";
                span.innerHTML = val;
            } else if (type === "boolean") {
                span.style.color = "var(--output-boolean-color)";
                span.innerHTML = val;
            } else if (type === "array") {
                const parentSpan = document.createElement("span");
                parentSpan.style.color = "var(--output-array-color)";
                parentSpan.innerHTML = "["; // opening bracket
                val.forEach((item, index) => {
                    parentSpan.appendChild(color(item));
                    if (index < val.length - 1) {
                        const comma = document.createElement("span");
                        comma.style.color = "#000000";
                        comma.innerHTML = ", ";
                        parentSpan.appendChild(comma);
                    }
                });
                parentSpan.appendChild(document.createTextNode("]")); // closing bracket
                return parentSpan;
            } else {
                span.innerHTML = val; // fallback
            }

            return span;
        }

        line.className = "output-line";
        line.appendChild(color(value));
        output.appendChild(line);
    }

    function updateLineNumbers() {
        const lines = editor.innerText.split("\n").length;
        lineNumbers.innerHTML = Array.from({length: lines}, (_, i) => i+1).join("<br>");
    }

    // Initial update
    updateLineNumbers();

    // Update on input
    editor.addEventListener("input", updateLineNumbers);

    // Keep line numbers scroll in sync
    editor.addEventListener("scroll", () => {
        lineNumbers.scrollTop = editor.scrollTop;
    });

    function runButton(){
        const code = editor.innerText;
        try {
            output.innerHTML = "";
            evaluateProgram(code);
        } catch (err) {
            output.textContent = "Error: " + err.message;
        }
    }

    document.getElementById("runBtn").addEventListener("click", runButton);

    runButton();
</script>