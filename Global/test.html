<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"
<!ATTLIST tag onsubmit CDATA #IMPLIED>
<head>
    <script src="./keybinds.js"></script>
    <script src="./crypt.js"></script>
    <script src="./game-components.js"></script>
    <script src="./math.js"></script>
    <script src="./step-creator.js"></script>
    <script src="./typewriter.js"></script>
</head>
<body>
    <div id="in">/Lorem ipsum dolor sit amet/, _consectetur adipiscing elit_, -*sed do eiusmod tempor incididunt ut labore et dolore magna aliqua*-. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliq!uip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.|the quick brown fox jumps over the lazy dog|new line~line break|/italic/ *bold* _underline_ -strikethrough-~escaped characters: \~\|\/\*\_\-\Â«\!</div>
    <div id="out"></div>
</body>
<script>
    let tw = new Typewriter2("in", "out", {
        onFinish: () => {
            console.log("done");
        }
    })
    tw.addColor(0, 11, "red")
    tw.start();
    tw.setSpeed(0);

    // let sc = new StepCreator(document.body);
    // sc.addSteps([
    //     new StepNode("radio").id("step1").description("radio")
    //         .addRadio("radio1")
    //         .radioOption("1", "one", "step2")
    //         .radioOption("2", "two", "step2")
    //         .radioOption("3", "three", "step2")
    //         .radioOption("4", "four", "step2")
    //     ,  
    //     new StepNode("radio").id("step2").description("radio 2")
    //         .addRadio("radio2")
    //         .radioOption("5", "five", ["step3", "step2-note5"])
    //         .radioOption("6", "six", ["step3", "step2-note6"])
    //         .radioOption("7", "seven", ["step3", "step2-note7"])
    //         .radioOption("8", "eight", ["step3", "step2-note8"])
    //     ,
    //     new StepNode("note").id("step2-note5").description("this is a note for 5!")
    //     ,
    //     new StepNode("note").id("step2-note6").description("this is a note for 6!")
    //     ,
    //     new StepNode("note").id("step2-note7").description("this is a note for 7!")
    //     ,
    //     new StepNode("note").id("step2-note8").description("this is a note for 8!")
    //     ,
    //     new StepNode("text").id("step3").placeholder("type something here").revealOnSubmit("step4").pattern(/\w+/)
    //     ,
    //     new StepNode("button").id("step4").description("this is a button!").addButton(() => {console.log(sc.currentData())})
    // ])
    /*
    let kb = new Keybinds();

    kb.createSingle("a", "up", function(){
        console.log("A was pressed on key up");
    });

    kb.createSingle("b", "down", function(){
        console.log("B was pressed on key down");
    });

    kb.createCombo("s+d+f", false, function(){
        console.log("S, D, and F were pressed");
    });

    kb.createCombo("w+e+r", true, function(){
        console.log("W, E, and R were pressed with full release");
    });

    kb.createDouble("x", 500, function(){
        console.log("X was double pressed within 500ms");
    });

    kb.createDouble("y", 1000, function(){
        console.log("Y was double pressed within 1000ms");
    });

    // create the element the player will control
    let playerElement = Player.CreatePlayerElement(50, 50, 100, 100, "red");

    // create the cannon component
    let cannonElement = Player.CreateComponentElement(25, 100, "blue");

    // create the player object
    let player = new Player(playerElement, 10, 10, "restrict");

    // create the cannon object
    let playerCannon = new GameObject(cannonElement, 37.5, 50)

    // add the cannon component to the player object
    player.addComponent(playerCannon);

    // create the bullet object

    kb.createMouse("left", "down", function(){
        let bulletElement = GameObject.CreateGameObjectElement(10, 10, "green")
        bulletElement.style.borderRadius = "50%";

        // add the bullet to the screen
        let bullet = new GameObject(bulletElement, 50, 50);

        // FIX ===================
        bullet.setVelocity(playerCannon.rotation, 10);
        bullet.setPosition(player.getCenter().x, player.getCenter().y)
    });
    
    // create the game object
    let game = new Game();
    // every game frame, update the player's position
    game.bind("playerUpdate", () => {
        player.updatePosition();
    })

    // every game frame, update the cannon's rotation to follow the mouse
    game.bind("update", () => {
        // get the angle between playerComponent and mouseX, mouseY
        let angle = (Math.atan2(kb.mousePos.y - player.getCenter().y, kb.mousePos.x - player.getCenter().x)) * (180/Math.PI) - 90;
        console.log(angle)
        playerCannon.rotate(angle, "top center", { y: -10 });

        GameObject.UpdateAll();
    })
    */
</script>